"use strict";Vue.component("stm-field-search",{data:function(){return{timeOut:null}},methods:{updateValue:function(t){var e=this;clearTimeout(this.timeOut),this.timeOut=setTimeout(function(){e.$emit("input",t),e.callback()},500)},callback:function(){this.callback_change&&this.callback_change()}},props:["callback_change","value","name","placeholder"]}),Vue.component("stm-field-checkbox",{data:function(){return{list:[]}},created:function(){this.list=this.build_items()},methods:{updateValue:function(){this.$emit("input",this.value),this.callback_change()},jsonCopy:function(t){return JSON.parse(JSON.stringify(t))},build_items:function(){var n=this,t=this.jsonCopy(n.items);return this.hide_empty&&(t=t.filter(function(t){return n.current_tab?null!=t.count&&0<t.count[n.current_tab]:null!=t.count&&0<t.count})),"name"==this.order_by&&("ASC"==this.order?t.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}):t.sort(function(t,e){return t.name>e.name?-1:t.name<e.name?1:0})),"count"==this.order_by&&("ASC"==this.order?t.sort(function(t,e){return n.current_tab?t.count[n.current_tab]-e.count[n.current_tab]:t.count-e.count}):t.sort(function(t,e){return n.current_tab?e.count[n.current_tab]-t.count[n.current_tab]:e.count-t.count})),t}},props:{value:{default:null},name:{default:null},placeholder:{default:null},items:{default:null},hide_empty:{default:!1},order_by:{default:null},order:{default:null},callback_change:{default:null},current_tab:{default:!1}}}),Vue.component("stm-field-proximity",{data:function(){return{setTimeoutEvent:null}},methods:{updateValue:function(t){var e=this,n=document.querySelector(".uListing-no-results-location");n&&n.classList.remove("uListing-no-results-location"),this.setTimeoutEvent&&clearTimeout(this.setTimeoutEvent),this.setTimeoutEvent=setTimeout(function(){e.$emit("input",t),e.callback_change()},100),setTimeout(function(){e.checkLocation()},1e3)},checkLocation:function(){for(var t=document.querySelectorAll(".inventory-location-filter"),e=0;e<t.length;e++){var n=t[e].querySelector("input");-1!==t[e].className.indexOf("uListing-empty-location")||n.value?n.value&&-1!==t[e].className.indexOf("uListing-empty-location")&&t[e].classList.remove("uListing-empty-location"):t[e].classList.add("uListing-empty-location")}}},props:["value","min","max","units","callback_change"]});var ADDRESS_COMPONENTS={subpremise:"short_name",street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",administrative_area_level_2:"long_name",country:"long_name",postal_code:"short_name"},CITIES_TYPE=["locality","administrative_area_level_3"],REGIONS_TYPE=["locality","sublocality","postal_code","country","administrative_area_level_1","administrative_area_level_2"];Vue.component("stm-field-location",{data:function(){return{checkTimes:0,noFound:!0,hasAccess:!1,checkTimer:null,autocomplete:null,autocompleteText:"",setIntervalInitMap:null,geolocation:{geocoder:null,loc:null,position:null},ajax_url:"https://nominatim.openstreetmap.org/search"}},created:function(){console.log("ok")},mounted:function(){var t=this;this.setIntervalInitAutocomplete=setInterval(function(){googleApiLoad&&t.initAutocomplete()},1e3)},methods:{initAutocomplete:function(){var t=this,e={};t.types&&(e.types=[t.types]),t.country&&(e.componentRestrictions={country:t.country}),t.autocomplete=new google.maps.places.Autocomplete(document.getElementById(t.id),e),t.autocomplete.addListener("place_changed",t.onPlaceChanged),window.clearInterval(t.setIntervalInitAutocomplete)},onPlaceChanged:function(){var t=this.autocomplete.getPlace();if(t.geometry){void 0!==t.address_components&&(this.$emit("placechanged",this.formatResult(t,document.getElementById(this.id).value),t,this.id),this.autocompleteText=document.getElementById(this.id).value,this.onChange());var e=this.formatResult(t,document.getElementById(this.id).value);this.value={address:e.route?e.route:t.formatted_address,lat:e.latitude,lng:e.longitude},this.$emit("input",this.value),this.callback_change(this.attribute_name),this.watchForChange()}else this.$emit("no-results-found",t,this.id)},startCheck:function(){var e=this;this.removeClass("uListing-empty-location");var t=document.getElementById(e.id),n=document.querySelectorAll(".pac-container"),o=t.value;setTimeout(function(){if(o&&e.autocompleteText!==o){var t=null;t=0<n.length?n[n.length-1].querySelectorAll(".pac-item").length:document.querySelectorAll(".pac-item").length,e.noFound=0<t}else""===o&&(e.noFound=!0)},100)},watchForInput:function(){var t=this;setTimeout(function(){t.startCheck()},200)},watchForChange:function(){this.removeClass("uListing-empty-location"),this.removeClass("uListing-no-results-location")},removeClass:function(n){setTimeout(function(){var t="."+n,e=document.querySelector(t);e&&e.classList.remove(n)},1)},onFocus:function(){this.biasAutocompleteLocation(),this.$emit("focus")},onBlur:function(){this.$emit("blur")},onChange:function(){this.$emit("change",this.autocompleteText)},onKeyPress:function(t){this.$emit("keypress",t)},onKeyUp:function(t){this.$emit("keyup",t)},clear:function(){this.autocompleteText=""},focus:function(){this.$refs.autocomplete.focus()},blur:function(){this.$refs.autocomplete.blur()},update:function(t,e){var n=1<arguments.length&&void 0!==e?e:null;this.autocompleteText=t,"function"==typeof n&&n()},updateCoordinates:function(t,e){var n=this,o=1<arguments.length&&void 0!==e?e:null;(t||t.lat||t.lng)&&(this.geolocation.geocoder||(this.geolocation.geocoder=new google.maps.Geocoder),this.geolocation.geocoder.geocode({location:t},function(t,e){"OK"===e?(t=n.filterGeocodeResultTypes(t))[0]?(n.$emit("placechanged",n.formatResult(t[0]),t[0],n.id),n.update(t[0].formatted_address,o)):n.$emit("error","no result for provided coordinates"):n.$emit("error","error getting address from coords")}))},geolocate:function(){var n=this;this.updateGeolocation(function(t,e){n.updateCoordinates(t)})},updateGeolocation:function(t){var n=this,o=0<arguments.length&&void 0!==t?t:null;if(navigator.geolocation){var e={};this.geolocationOptions&&Object.assign(e,this.geolocationOptions),navigator.geolocation.getCurrentPosition(function(t){var e={lat:t.coords.latitude,lng:t.coords.longitude};n.geolocation.loc=e,n.geolocation.position=t,o&&o(e,t)},function(t){n.$emit("error","Cannot get Coordinates from navigator",t)},e)}},biasAutocompleteLocation:function(){var o=this;this.enableGeolocation&&this.updateGeolocation(function(t,e){var n=new google.maps.Circle({center:t,radius:e.coords.accuracy});o.autocomplete.setBounds(n.getBounds())})},formatResult:function(t,e){for(var n={},o=0;o<t.address_components.length;o++){var a=t.address_components[o].types[0];if(ADDRESS_COMPONENTS[a]){var i=t.address_components[o][ADDRESS_COMPONENTS[a]];n[a]=i}}return n.route=e,n.latitude=t.geometry.location.lat(),n.longitude=t.geometry.location.lng(),n},filterGeocodeResultTypes:function(t){if(!t||!this.types)return t;var e=[],n=[this.types];n.includes("(cities)")&&(n=n.concat(CITIES_TYPE)),n.includes("(regions)")&&(n=n.concat(REGIONS_TYPE));var o=!0,a=!1,i=void 0;try{for(var l,u=t[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var r=l.value,c=!0,s=!1,d=void 0;try{for(var m,p=r.types[Symbol.iterator]();!(c=(m=p.next()).done);c=!0){var h=m.value;if(n.includes(h)){e.push(r);break}}}catch(t){s=!0,d=t}finally{try{!c&&p.return&&p.return()}finally{if(s)throw d}}}}catch(t){a=!0,i=t}finally{try{!o&&u.return&&u.return()}finally{if(a)throw i}}return e},findMyLocation:function(){var n=this;navigator.geolocation&&("https:"!==location.protocol?jQuery.getJSON("http://ipinfo.io",function(t){var e=t.loc.split(",");n.renderMyLocationHttp(e)}):navigator.geolocation.getCurrentPosition(n.renderMyLocation,n.myLocationFail,{timeout:1e4}))},myLocationFail:function(){alert("The browser couldn't detect your location")},renderMyLocation:function(e){var n=this;e=[e.coords.latitude,e.coords.longitude],n.updateCoordinates({lat:e[0],lng:e[1]},function(){if(document.getElementById(n.id)){document.getElementById(n.id).value=n.autocompleteText,n.onChange();var t={address:n.autocompleteText,lat:e[0],lng:e[1]};n.$emit("input",t),n.callback_change("location")}}),n.map&&(n.map.setZoom(n.map.getZoom()),n.map.setCenter(n.getPoint(e)),n.getMarker(e))},renderMyLocationHttp:function(o){var a=this;a.$http.get(a.ajax_url+"?format=json&q="+o[0]+"+"+o[1]).then(function(t){if(0===t.body.length)return!1;var e=t.body[0];if(200===t.status&&e){document.getElementById(a.id)&&(document.getElementById(a.id).value=e.display_name);var n={lat:e.lat,lng:e.lon,address:e.display_name};a.onChange(),a.$emit("input",n),a.callback_change("location"),a.map&&(a.map.setZoom(a.map.getZoom()),a.map.setCenter(a.getPoint(o)),a.getMarker(o))}})},getPoint:function(t){return new google.maps.LatLng(t[0],t[1])},getMarker:function(t){return new google.maps.Marker({position:this.getPoint(t),map:this.map,icon:this.icon_url,shape:this.getShape(),title:"",zIndex:999999,image:"",price:"",category:"",action:"",link:"",infoWindowIndex:99})},getShape:function(){return{coord:[1,1,1,38,38,59,59,1],type:"poly"}}},props:{icon_url:{default:""},map:{default:null},id:{default:"autocomplete"},callback_change:{default:null},value:{type:Object,default:{address:"",lat:0,lng:0}},name:{default:null},placeholder:{type:String,default:"Enter your address"},country:{type:[String,Array],default:null},enableGeolocation:{type:Boolean,default:!1},geolocationOptions:{type:Object,default:null},attribute_name:{default:null}},watch:{autocompleteText:function(t,e){this.$emit("inputChange",{newVal:t,oldVal:e},this.id)},country:function(t,e){this.autocomplete.setComponentRestrictions({country:null===this.country?[]:this.country})}}});var $=jQuery;Vue.component("stm-field-osm-location",{props:{id:{default:"autocomplete"},callback_change:{default:null},map:{default:null},value:{type:Object,default:{address:"",lat:0,lng:0}},icon_url:{default:""},name:{default:null},placeholder:{type:String,default:"Enter your address"},country:{type:[String,Array],default:null},enableGeolocation:{type:Boolean,default:!1},geolocationOptions:{type:Object,default:null},attribute_name:{default:null},access_token:{default:""}},data:function(){return{query:"",setIntervalInitAutocomplete:null,autocomplete:null,autocompleteText:"",current_position:null,geolocation:{geocoder:null,loc:null,position:null},ajax_url:"https://nominatim.openstreetmap.org/search"}},mounted:function(){var t=this;setTimeout(function(){t.renderAutoComplete()},1e3)},methods:{renderAutoComplete:function(){var n=this;n.query="#"+n.id,$(n.query).autocomplete({source:function(t,e){$.get(n.ajax_url,{format:"json",q:t.term},function(t){t.length?(e(t.map(function(t){return{latitude:t.lat,longitude:t.lon,label:t.display_name,value:t.display_name}})),$(".ui-autocomplete").width($(n.query).parent().width()),this.autocompleteText=$(n.query).val()):e([{value:"",label:"No results found"}])},"json")},select:function(t,e){n.value={address:e.item.value,lat:e.item.latitude,lng:e.item.longitude},n.onChange(),n.$emit("input",n.value),n.callback_change(n.attribute_name)}})},onChange:function(){this.$emit("change",this.autocompleteText)},findMyLocation:function(){var e=this;"https:"===location.protocol?(e.map.on("locationfound",e.onLocationFound),e.map.on("locationerror",e.onLocationError),setTimeout(function(){e.map.locate({setView:!0,maxZoom:16})},1e3)):jQuery.getJSON("http://ipinfo.io",function(t){e.renderLocation(t)})},renderLocation:function(t){var a=this,e=t.loc.split(",");a.$http.get(a.ajax_url+"?format=json&q="+e[0]+"+"+e[1]).then(function(t){if(0===t.body.length)return!1;var e=t.body[0];if(200===t.status&&e){$(a.query).val(e.display_name);var n={lat:e.lat,lng:e.lon,address:e.display_name};a.onChange(),a.$emit("input",n),a.callback_change("location"),a.current_position&&a.map.removeLayer(a.current_position);var o=L.icon({iconUrl:a.icon_url});a.current_position=L.marker({lat:e.lat,lng:e.lon},{icon:o}).addTo(a.map),a.map.panTo(new L.LatLng(e.lat,e.lon)),a.map.setZoom(a.map.getZoom())}})},onLocationFound:function(a){var i=this;i.$http.get(i.ajax_url+"?format=json&q="+a.latlng.lat+"+"+a.latlng.lng).then(function(t){if(0===t.body.length)return!1;var e=t.body[0];if(200===t.status&&e){$(i.query).val(e.display_name);var n={lat:e.lat,lng:e.lon,address:e.display_name};i.onChange(),i.$emit("input",n),i.callback_change("location"),i.current_position&&i.map.removeLayer(i.current_position);var o=L.icon({iconUrl:i.icon_url});i.current_position=L.marker(a.latlng,{icon:o}).addTo(i.map)}})},onLocationError:function(t){alert(t.message)}}}),Vue.component("stm-field-range",{data:function(){return{setTimeoutEvent:null,from:0,to:0,cloneTo:0,cloneFrom:0}},created:function(){this.from=this.value[0],this.to=this.value[1],this.cloneFrom=this.from,this.cloneTo=this.to,this.to=this.setSings(this.to),this.from=this.setSings(this.from)},methods:{updateValue:function(t){t=this.splitValues(t.split(";")),this.$emit("input",t),this.callback_change()},setValue:function(t){var e=this;e.setTimeoutEvent&&clearTimeout(e.setTimeoutEvent),e.setTimeoutEvent=setTimeout(function(){e.updateValue(t)},1e3)},setSings:function(t){var e=this;return e.suffix&&-1===t.indexOf(e.suffix)&&(t+=e.suffix),e.prefix&&-1===t.indexOf(e.prefix)&&(t=e.prefix+t),t},splitValues:function(t){for(var e=0;e<t.length;e++)t[e]=t[e].replace(this.suffix,""),t[e]=t[e].replace(this.prefix,"");return this.cloneFrom=t[0],this.cloneTo=t[1],t}},props:["value","min","max","prefix","suffix","callback_change"]}),Vue.component("stm-field-dropdown",{data:function(){return{list:[]}},created:function(){this.list=this.build_items()},methods:{jsonCopy:function(t){return JSON.parse(JSON.stringify(t))},updateValue:function(){this.$emit("input",this.value),this.callback_change(this.attribute_name)},build_items:function(){var e=this,n=[],t=this.jsonCopy(e.items);return this.hide_empty&&(t=t.filter(function(t){return null!=t.count&&0<t.count})),"name"==this.order_by&&("ASC"==this.order?t.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0}):t.sort(function(t,e){return t.name>e.name?-1:t.name<e.name?1:0})),"count"==this.order_by&&("ASC"==this.order?t.sort(function(t,e){return t.count-e.count}):t.sort(function(t,e){return e.count-t.count})),t.forEach(function(t){n.push({id:t.value,text:t.name,selected:e.value==t.value})}),n}},props:["value","name","placeholder","items","hide_empty","order_by","order","callback_change","attribute_name"],watch:{value:function(t,e){t!=e&&this.updateValue()}}}),Vue.component("date-picker",DatePicker.default),Vue.component("stm-field-date",{data:function(){return{lang:{days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pickers:["next 7 days","next 30 days","previous 7 days","previous 30 days"],placeholder:{date:"Select Date",dateRange:"Select Date Range"}}}},methods:{test:function(){},setValue:function(){this.date_type,this.date_type,this.updateValue(),this.callback_change()},updateValue:function(){this.$emit("input",this.value)}},watch:{value:function(t){t||(this.updateValue(),this.callback_change())}},mounted:function(){},props:["callback_change","value","name","date_type","placeholder"]});